# SPDX-License-Identifier: Apache-2.0
# Pre-commit hooks configuration for Zephyr RTOS motor control framework

repos:
  # General code quality checks
  - repo: https://github.com/pre-commit/pre-commit-hooks
    rev: v4.6.0
    hooks:
      - id: trailing-whitespace
        name: Remove trailing whitespace
      - id: end-of-file-fixer
        name: Ensure file ends with a newline
      - id: check-yaml
        name: Check YAML file syntax
        args: ['--unsafe']  # Allow custom tags (required for Zephyr devicetree)
      - id: check-added-large-files
        name: Check for added large files
        args: ['--maxkb=1024']
      - id: check-merge-conflict
        name: Check for merge conflict markers
      - id: check-case-conflict
        name: Check for file name case conflicts
      - id: mixed-line-ending
        name: Check for mixed line endings
        args: ['--fix=lf']

  # C/C++ code formatting
  - repo: https://github.com/pre-commit/mirrors-clang-format
    rev: v19.1.6
    hooks:
      - id: clang-format
        name: C/C++ code formatting
        types_or: [c, c++]
        args: ['-i']  # Modify files in-place

  # CMake file formatting
  - repo: https://github.com/cheshirekow/cmake-format-precommit
    rev: v0.6.13
    hooks:
      - id: cmake-format
        name: CMake file formatting
        additional_dependencies: [pyyaml]
      - id: cmake-lint
        name: CMake file lint
        additional_dependencies: [pyyaml]
        args: ['--disabled-codes=C0113']  # Disable certain unnecessary warnings

  # Shell script lint
  - repo: https://github.com/shellcheck-py/shellcheck-py
    rev: v0.10.0.1
    hooks:
      - id: shellcheck
        name: Shell script lint

  # Python code formatting (for scripts)
  - repo: https://github.com/psf/black
    rev: 24.10.0
    hooks:
      - id: black
        name: Python code formatting
        language_version: python3

  # Python import sorting
  - repo: https://github.com/pycqa/isort
    rev: 5.13.2
    hooks:
      - id: isort
        name: Python import sorting
        args: ["--profile", "black"]

# Global configuration
default_language_version:
  python: python3

# Excluded files and directories
exclude: |
  (?x)^(
      build/.*|
      \.git/.*|
      zephyr/.*|
      .*\.patch$|
      .*\.diff$
  )$
